内存虚拟化
---------
主存：由M个连续的字节大小的单元组成的数组。每个字节有唯一物理地址PA。
地址空间：非负整数地址的有序集合：{0,1,2,...}。地址空间大小由表示最大地址所需位数描述
虚拟内存：一个由存放在磁盘上的N个连续的字节大小的单元组成的数组
将虚拟内存(VM)分割为虚拟页(VP)的大小固定的虚拟块，每个虚拟页大小P=2^p字节
将物理内存(PM)分割为物理页(PP)(也叫页帧(PF))，大小P。
页表将虚拟页映射到物理页。页表是一个页表条目(PTE)的数组。
CPU通过生成VA给内存管理单元(MMU),MMU生成PTE,从L1cache得到它，L1向MMU返回PTE,MMU构造物理地址传送给L1,L1返回数据给CPU。
利用TLB加速地址翻译：在MMU中加一个关于PLT的缓存。
多级页表：使用层次结构的页表来压缩页表。

代码改动
-------
将内核代码放在虚拟地址空间以0xffffffffc0200000开始的一段高地址空间中(修改linker64.ld,consts.rs)。修改后需将虚拟地址转化为物理地址，偏移量：0xffffffffc0200000-0x80200000=0xffffffff40000000。当访问内核里面一个虚拟地址va时，则物理地址：pa=va-0xffffffff40000000。
将一个三级页表项的标志位R,W,X不设为全0，可将它变为一个叶子，得到大小为1GiB的大页。
假定内核大小不超过1GiB，因此通过一个大页，将虚拟地址区间[0xffffffffc0000000，0xffffffffffffffff]映射到物理地址空间[0x80000000,0xc0000000]。(见entry64.asm)

进入虚拟内存访问：
1.分配页表所在内存空间并初始化页表
2.设置好页基址寄存器（指向页表起始地址）
3.刷新TLB